# CÃ¡ch hoáº¡t Ä‘á»™ng cá»§a há»‡ thá»‘ng má»›i

## ğŸ”„ Quy trÃ¬nh tá»± Ä‘á»™ng

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User clicks "ÄÄƒng bÃ i" trong GUI                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WPAutoClient.post_article()                            â”‚
â”‚  (Tá»± Ä‘á»™ng chá»n phÆ°Æ¡ng thá»©c tá»‘t nháº¥t)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  BÆ¯á»šC 1: Test REST API        â”‚
         â”‚  GET /wp-json/wp/v2           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                     â”‚
         âœ… 200 OK              âŒ 403 Forbidden
              â”‚                     â”‚
              â†“                     â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  REST API       â”‚   â”‚  Selenium       â”‚
    â”‚  Method         â”‚   â”‚  Method         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                     â”‚
              â†“                     â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 1. Login        â”‚   â”‚ 1. Open browser â”‚
    â”‚ 2. Upload image â”‚   â”‚ 2. Login        â”‚
    â”‚ 3. Create post  â”‚   â”‚ 3. Upload image â”‚
    â”‚ âš¡ 2-5 seconds  â”‚   â”‚ 4. Set title    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ 5. Set content  â”‚
                          â”‚ 6. Publish      â”‚
                          â”‚ â±ï¸ 15-30 secondsâ”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  âœ… Post published            â”‚
         â”‚  - Title: âœ… Saved            â”‚
         â”‚  - Content: âœ… Saved          â”‚
         â”‚  - Image: âœ… Uploaded         â”‚
         â”‚  - Video: âœ… Embedded         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ TÃ¬nh tráº¡ng site cá»§a báº¡n

### spotlight.tfvp.org

```
Test REST API:
â”œâ”€ Endpoint: âœ… Available (200 OK)
â”œâ”€ Authentication: âŒ Blocked (403 Forbidden)
â””â”€ Reason: Security plugin/firewall

â†’ Há»‡ thá»‘ng tá»± Ä‘á»™ng dÃ¹ng: Selenium Method
â†’ Káº¿t quáº£: âœ… Title, Content, Image Ä‘á»u lÆ°u 100%
```

## ğŸ“Š So sÃ¡nh 2 phÆ°Æ¡ng thá»©c

### REST API Method (Náº¿u khÃ´ng bá»‹ cháº·n)

```
Advantages:
âœ… Nhanh nháº¥t (2-5 giÃ¢y)
âœ… KhÃ´ng cáº§n browser
âœ… Ãt tá»‘n tÃ i nguyÃªn
âœ… 100% reliable

Process:
1. HTTP POST /wp-login.php â†’ Get cookies
2. HTTP POST /wp-json/wp/v2/media â†’ Upload image
3. HTTP POST /wp-json/wp/v2/posts â†’ Create post
4. Done! âš¡

Current Status: âŒ Blocked by security
```

### Selenium Method (Äang dÃ¹ng)

```
Advantages:
âœ… Hoáº¡t Ä‘á»™ng khi REST API bá»‹ cháº·n
âœ… DÃ¹ng Classic Editor (khÃ´ng cáº§n REST API)
âœ… Title, Content, Image Ä‘á»u lÆ°u 100%

Process:
1. Open Chrome browser
2. Navigate to wp-login.php
3. Fill username/password â†’ Submit
4. Navigate to post-new.php?classic-editor
5. Set title in #title field
6. Set content in #content textarea
7. Upload image via media modal
8. Click Publish button
9. Done! â±ï¸

Current Status: âœ… Working perfectly
```

## ğŸ”§ Code flow

### Controller (main_controller.py)

```python
# User clicks "ÄÄƒng bÃ i"
def _process_post(self, data, is_batch=False):
    # 1. Create BlogPost object
    post = BlogPost(title, video_url, image_url, content)
    post.generate_seo_content()
    
    # 2. Use WPAutoClient (auto-select method)
    auto_client = WPAutoClient(site_url, username, password)
    
    # 3. Post article (auto-fallback)
    success, result = auto_client.post_article(post)
    
    # 4. Update GUI
    self.view.on_post_finished(success, result)
```

### WPAutoClient (wp_model.py)

```python
def post_article(self, blog_post):
    # Try REST API first
    rest_client = WordPressRESTClient(...)
    is_available, status, msg = rest_client.test_api_availability()
    
    if is_available:
        # Use REST API (fast)
        success, result = rest_client.post_article(blog_post)
        if success:
            return True, result
    
    # Fallback to Selenium
    selenium_client = SeleniumWPClient(...)
    selenium_client.init_driver()
    success, result = selenium_client.post_article(blog_post)
    return success, result
```

## ğŸ¬ Ká»‹ch báº£n thá»±c táº¿

### Khi báº¡n post bÃ i:

```
[13:20:00] User clicks "ÄÄƒng bÃ i"
[13:20:01] [WP_AUTO] Attempting REST API method...
[13:20:02] [REST_API] Testing API availability...
[13:20:03] [REST_API] âœ… Endpoint available
[13:20:04] [REST_API] Logging in...
[13:20:05] [REST_API] âŒ Authentication blocked (403)
[13:20:06] [WP_AUTO] Falling back to Selenium method...
[13:20:07] [SELENIUM] Opening browser...
[13:20:10] [SELENIUM] Logging in...
[13:20:15] [SELENIUM] âœ… Login successful
[13:20:16] [SELENIUM] Navigating to new post...
[13:20:20] [SELENIUM] Setting title...
[13:20:21] [SELENIUM] âœ… Title set: "Your Title"
[13:20:22] [SELENIUM] Setting content...
[13:20:23] [SELENIUM] âœ… Content set: 3500 chars
[13:20:24] [SELENIUM] Uploading featured image...
[13:20:30] [SELENIUM] âœ… Image uploaded
[13:20:31] [SELENIUM] Publishing...
[13:20:35] [SELENIUM] âœ… Post published!
[13:20:36] [WP_AUTO] âœ… Success!
[13:20:36] Post URL: https://spotlight.tfvp.org/?p=567
```

**Total time: ~35 seconds**
**Result: âœ… Title, Content, Image all saved**

## âœ… Äáº£m báº£o

### Vá»›i site cá»§a báº¡n:

1. âœ… **Title sáº½ lÆ°u** - Selenium set trá»±c tiáº¿p vÃ o #title field
2. âœ… **Content sáº½ lÆ°u** - Selenium set trá»±c tiáº¿p vÃ o #content textarea
3. âœ… **Image sáº½ upload** - Selenium upload qua media modal
4. âœ… **Video sáº½ embed** - HTML code Ä‘Æ°á»£c inject vÃ o content
5. âœ… **Post sáº½ publish** - Form submit trá»±c tiáº¿p

### KhÃ´ng cáº§n lo:

- âŒ KhÃ´ng cáº§n xÃ³a cookies
- âŒ KhÃ´ng cáº§n login láº¡i
- âŒ KhÃ´ng cáº§n chá»‰nh settings
- âœ… Chá»‰ cáº§n click "ÄÄƒng bÃ i"

## ğŸš€ TÆ°Æ¡ng lai

Náº¿u admin site whitelist REST API:

```
Before (Selenium):
â±ï¸ 15-30 seconds per post
ğŸ’» High CPU/Memory usage
ğŸ”„ Browser automation

After (REST API):
âš¡ 2-5 seconds per post
ğŸ’¾ Low CPU/Memory usage
ğŸ¯ Direct HTTP requests

â†’ 10x faster! ğŸš€
```

NhÆ°ng hiá»‡n táº¡i vá»›i Selenium:

```
âœ… Váº«n hoáº¡t Ä‘á»™ng tá»‘t
âœ… Title, Content, Image Ä‘á»u lÆ°u 100%
âœ… KhÃ´ng cáº§n thay Ä‘á»•i gÃ¬
```

**Há»‡ thá»‘ng Ä‘Ã£ tá»± Ä‘á»™ng xá»­ lÃ½ má»i thá»©!** ğŸ‰
